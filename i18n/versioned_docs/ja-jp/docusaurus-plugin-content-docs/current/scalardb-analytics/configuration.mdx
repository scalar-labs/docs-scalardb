---
tags:
  - Enterprise Option
displayed_sidebar: docsJapanese
---

# 設定リファレンス

このページでは、ScalarDB Analytics のすべてのコンポーネントの設定に関する包括的なリファレンスを提供します。

## 概要

ScalarDB Analytics は、設定が必要な 3 つの主要コンポーネントで構成されています：

1. **ScalarDB Analytics サーバー** - カタログとメータリングサービスをホストするサーバー
2. **CLI クライアント** - カタログとデータソースを管理するためのコマンドラインインターフェース
3. **Spark 統合** - Apache Spark で ScalarDB Analytics を使用するための設定

## ScalarDB Analytics サーバー設定

サーバーは、データベース接続、ネットワーク設定、ライセンス、オプション機能を定義する標準的な Java プロパティファイル（例：`scalardb-analytics-server.properties`）を使用して設定されます。

### 設定プロパティ

#### メタデータデータベース設定

サーバーは、カタログ情報を保存するためのメタデータデータベースが必要です。

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `scalar.db.analytics.server.db.url` | はい | - | メタデータデータベースの JDBC URL | `jdbc:postgresql://localhost:5432/scalardb_analytics` |
| `scalar.db.analytics.server.db.username` | はい | - | 認証用のデータベースユーザー | `analytics_user` |
| `scalar.db.analytics.server.db.password` | はい | - | 認証用のデータベースパスワード | `your_secure_password` |

#### gRPC サーバー設定

カタログおよびメータリングサービスのポートを設定します。

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `scalar.db.analytics.server.catalog.port` | いいえ | `11051` | カタログサービスのポート | `11051` |
| `scalar.db.analytics.server.metering.port` | いいえ | `11052` | メータリングサービスのポート | `11052` |

#### TLS 設定

セキュアな通信のために TLS/SSL を有効にします。

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `scalar.db.analytics.server.tls.enabled` | いいえ | `false` | gRPC エンドポイントの TLS/SSL を有効にする | `true` |
| `scalar.db.analytics.server.tls.cert_chain_path` | はい* | - | サーバー証明書チェーンファイルへのパス | `/path/to/server.crt` |
| `scalar.db.analytics.server.tls.private_key_path` | はい* | - | サーバー秘密鍵ファイルへのパス | `/path/to/server.key` |

\* `tls.enabled` が `true` の場合に必須

#### ライセンス設定

ScalarDB Analytics ライセンスを設定します。

| プロパティ | 必須 | 説明 | デフォルト | 例 |
| --- | --- | --- | --- | --- |
| `scalar.db.analytics.server.licensing.license_key` | はい | ScalarDB Analytics ライセンスキー | - | ライセンスについては Scalar に連絡 |
| `scalar.db.analytics.server.licensing.license_check_cert_pem` | はい* | PEM 文字列としてのライセンス検証証明書 | - | 証明書については Scalar に連絡 |
| `scalar.db.analytics.server.licensing.license_check_cert_path` | はい* | ライセンス検証証明書ファイルへのパス | - | `/path/to/cert.pem` |

\* `license_check_cert_pem` または `license_check_cert_path` のいずれかを指定する必要があります

#### メータリングストレージ設定

メータリングデータのストレージを設定します。

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `scalar.db.analytics.server.metering.storage.provider` | はい | - | メータリングデータのストレージプロバイダー（`filesystem`、`aws-s3`、`azureblob`、`google-cloud-storage`） | `filesystem` |
| `scalar.db.analytics.server.metering.storage.containerName` | いいえ | `metering` | クラウドストレージ用のコンテナ/バケット名 | `my-metering-bucket` |
| `scalar.db.analytics.server.metering.storage.path` | はい* | - | ローカルディレクトリパス（`filesystem` プロバイダーのみ） | `/var/scalardb-analytics/metering` |
| `scalar.db.analytics.server.metering.storage.accessKeyId` | はい** | - | クラウドストレージプロバイダー用のアクセスキー ID | `AKIAIOSFODNN7EXAMPLE` |
| `scalar.db.analytics.server.metering.storage.secretAccessKey` | はい** | - | クラウドストレージプロバイダー用のシークレットアクセスキー | `wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY` |
| `scalar.db.analytics.server.metering.storage.prefix` | いいえ | - | すべてのストレージパスのオプションのプレフィックス | `production/` |

\* プロバイダーが `filesystem` の場合に必須  
\** クラウドストレージプロバイダー（`aws-s3`、`azureblob`、`google-cloud-storage`）の場合に必須

## CLI クライアント設定

CLI クライアントは、ScalarDB Analytics サーバーと通信するための接続設定を Java プロパティファイル（例：`client.properties`）を使用して設定します。

### 設定プロパティ

#### サーバー接続設定

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `scalar.db.analytics.client.server.host` | はい | - | ScalarDB Analytics サーバーのホスト名または IP アドレス | `analytics.example.com` |
| `scalar.db.analytics.client.server.catalog.port` | いいえ | `11051` | カタログサービスのポート番号 | `11051` |
| `scalar.db.analytics.client.server.metering.port` | いいえ | `11052` | メータリングサービスのポート番号 | `11052` |

#### TLS 設定

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `scalar.db.analytics.client.server.tls.enabled` | いいえ | `false` | サーバー接続の TLS/SSL を有効にする | `true` |
| `scalar.db.analytics.client.server.tls.ca_root_cert_path` | はい* | - | サーバー証明書を検証するための CA 証明書ファイルへのパス | `/path/to/cert.pem` |
| `scalar.db.analytics.client.server.tls.override_authority` | いいえ | - | TLS 検証のためのサーバー権限をオーバーライド（テストに便利） | `test.example.com` |

\* `tls.enabled` が `true` の場合に必須

## Spark 統合設定

Apache Spark で ScalarDB Analytics を使用するには、Spark 設定ファイル（`spark-defaults.conf`）に必要な設定を追加して Spark アプリケーションを設定します。

### 設定プロパティ

#### コア Spark 設定

| プロパティ | 必須 | 説明 | デフォルト | 例 |
| --- | --- | --- | --- | --- |
| `spark.jars.packages` | はい | ScalarDB Analytics 依存関係の Maven 座標 | - | `com.scalar-labs:scalardb-analytics-spark-all-3.5_2.12:3.16.2` |
| `spark.extraListeners` | はい | ScalarDB Analytics メータリングリスナーを登録 | - | `com.scalar.db.analytics.spark.metering.ScalarDbAnalyticsListener` |

`spark.jars.packages` では以下を置換してください：
- `<SPARK_VERSION>` を Spark バージョンに（例：`3.5`）
- `<SCALA_VERSION>` を Scala バージョンに（例：`2.12`）
- `<SCALARDB_ANALYTICS_VERSION>` を ScalarDB Analytics バージョンに（例：`3.16.2`）

#### カタログ設定

| プロパティ | 必須 | 説明 | デフォルト | 値 |
| --- | --- | --- | --- | --- |
| `spark.sql.catalog.<catalog-name>` | はい | ScalarDB Analytics カタログ実装を登録 | - | `com.scalar.db.analytics.spark.catalog.ScalarDBAnalyticsCatalog` |

#### サーバー接続設定

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `spark.sql.catalog.<catalog-name>.server.host` | はい | - | ScalarDB Analytics サーバーのホスト名または IP アドレス | `localhost` |
| `spark.sql.catalog.<catalog-name>.server.catalog.port` | いいえ | `11051` | カタログサービスのポート番号 | `11051` |
| `spark.sql.catalog.<catalog-name>.server.metering.port` | いいえ | `11052` | メータリングサービスのポート番号 | `11052` |

#### TLS/SSL 設定

| プロパティ | 必須 | デフォルト | 説明 | 例 |
| --- | --- | --- | --- | --- |
| `spark.sql.catalog.<catalog-name>.server.tls.enabled` | いいえ | `false` | サーバー接続の TLS/SSL を有効にする | `true` |
| `spark.sql.catalog.<catalog-name>.server.tls.ca_root_cert_path` | はい* | - | サーバー証明書を検証するための CA 証明書ファイルへのパス | `/path/to/cert.pem` |
| `spark.sql.catalog.<catalog-name>.server.tls.override_authority` | いいえ | - | TLS 検証のためのサーバー権限をオーバーライド | `test.example.com` |

\* `tls.enabled` が `true` の場合に必須

`<catalog-name>` を選択したカタログ名（例：`analytics`）に置き換えてください。

## 設定例

### 基本的な開発設定

#### サーバー設定（`scalardb-analytics-server.properties`）

```properties
# メタデータデータベース
scalar.db.analytics.server.db.url=jdbc:postgresql://localhost:5432/scalardb_analytics
scalar.db.analytics.server.db.username=dev_user
scalar.db.analytics.server.db.password=dev_password

# ライセンス
scalar.db.analytics.server.licensing.license_key=YOUR_DEV_LICENSE_KEY
scalar.db.analytics.server.licensing.license_check_cert_path=/path/to/license_cert.pem

# メータリングストレージ（開発用に filesystem）
scalar.db.analytics.server.metering.storage.provider=filesystem
scalar.db.analytics.server.metering.storage.path=/tmp/scalardb-analytics-metering
```

#### クライアント設定（`client.properties`）

```properties
scalar.db.analytics.client.server.host=localhost
```

#### Spark 設定（`spark-defaults.conf`）

```properties
spark.jars.packages                         com.scalar-labs:scalardb-analytics-spark-all-3.5_2.12:3.16.2
spark.extraListeners                        com.scalar.db.analytics.spark.metering.ScalarDbAnalyticsListener
spark.sql.catalog.analytics                 com.scalar.db.analytics.spark.catalog.ScalarDBAnalyticsCatalog
spark.sql.catalog.analytics.server.host     localhost
```

### TLS を使用した本番設定

#### サーバー設定（`scalardb-analytics-server.properties`）

```properties
# メタデータデータベース
scalar.db.analytics.server.db.url=jdbc:postgresql://db.internal:5432/scalardb_analytics_prod
scalar.db.analytics.server.db.username=analytics_prod
scalar.db.analytics.server.db.password=your_secure_password

# gRPC ポート
scalar.db.analytics.server.catalog.port=11051
scalar.db.analytics.server.metering.port=11052

# TLS
scalar.db.analytics.server.tls.enabled=true
scalar.db.analytics.server.tls.cert_chain_path=/path/to/server.crt
scalar.db.analytics.server.tls.private_key_path=/path/to/server.key

# ライセンス
scalar.db.analytics.server.licensing.license_key=YOUR_LICENSE_KEY
scalar.db.analytics.server.licensing.license_check_cert_pem=-----BEGIN CERTIFICATE-----\nMIID...certificate content...\n-----END CERTIFICATE-----

# メータリングストレージ（S3）
scalar.db.analytics.server.metering.storage.provider=aws-s3
scalar.db.analytics.server.metering.storage.containerName=analytics-metering
scalar.db.analytics.server.metering.storage.accessKeyId=AKIAIOSFODNN7EXAMPLE
scalar.db.analytics.server.metering.storage.secretAccessKey=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
scalar.db.analytics.server.metering.storage.prefix=prod/
```

#### クライアント設定（`client.properties`）

```properties
scalar.db.analytics.client.server.host=analytics.example.com
scalar.db.analytics.client.server.tls.enabled=true
scalar.db.analytics.client.server.tls.ca_root_cert_path=/path/to/cert.pem
```

#### Spark 設定（`spark-defaults.conf`）

```properties
spark.jars.packages                                     com.scalar-labs:scalardb-analytics-spark-all-3.5_2.12:3.16.2
spark.extraListeners                                    com.scalar.db.analytics.spark.metering.ScalarDbAnalyticsListener
spark.sql.catalog.analytics                             com.scalar.db.analytics.spark.catalog.ScalarDBAnalyticsCatalog
spark.sql.catalog.analytics.server.host                 analytics.example.com
spark.sql.catalog.analytics.server.tls.enabled          true
spark.sql.catalog.analytics.server.tls.ca_root_cert_path /path/to/cert.pem
```

## 次のステップ

- [分析クエリの実行](run-analytical-queries.mdx) - 設定でクエリの実行を開始
- [デプロイメントガイド](deployment.mdx) - 本番環境での ScalarDB Analytics のデプロイ